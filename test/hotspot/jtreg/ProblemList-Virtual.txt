#
# Copyright (c) 2022, 2023, Oracle and/or its affiliates. All rights reserved.
# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
#
# This code is free software; you can redistribute it and/or modify it
# under the terms of the GNU General Public License version 2 only, as
# published by the Free Software Foundation.
#
# This code is distributed in the hope that it will be useful, but WITHOUT
# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
# version 2 for more details (a copy is included in the LICENSE file that
# accompanied this code).
#
# You should have received a copy of the GNU General Public License version
# 2 along with this work; if not, write to the Free Software Foundation,
# Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
#
# Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
# or visit www.oracle.com if you need additional information or have any
# questions.
#

####
# Bugs

serviceability/jvmti/Heap/IterateHeapWithEscapeAnalysisEnabled.java 8264699 generic-all
compiler/jvmci/compilerToVM/MaterializeVirtualObjectTest.java       8307125 generic-all

####
## Classes not unloaded as expected (TODO, need to check if FJ keeps a reference)

vmTestbase/nsk/jvmti/CompiledMethodUnload/compmethunload001/TestDescription.java 8300711 generic-all

####
## Tests for functionality which currently is not supported for virtual threads

vmTestbase/nsk/jvmti/GetCurrentThreadCpuTime/curthrcputime001/TestDescription.java 8300708 generic-all
vmTestbase/nsk/jvmti/GetThreadCpuTime/thrcputime001/TestDescription.java 8300708 generic-all
vmTestbase/nsk/jvmti/NotifyFramePop/nframepop002/TestDescription.java    8300708 generic-all
vmTestbase/nsk/jvmti/NotifyFramePop/nframepop003/TestDescription.java    8300708 generic-all
vmTestbase/nsk/jvmti/PopFrame/popframe004/TestDescription.java           8300708 generic-all
vmTestbase/nsk/jvmti/StopThread/stopthrd006/TestDescription.java         8300708 generic-all
vmTestbase/nsk/jvmti/scenarios/events/EM02/em02t012/TestDescription.java 8300708 generic-all
vmTestbase/nsk/jvmti/SetLocalVariable/setlocal004/TestDescription.java   8300708 generic-all
vmTestbase/nsk/jvmti/SetLocalVariable/setlocal003/TestDescription.java   8300708 generic-all
vmTestbase/nsk/jvmti/SetLocalVariable/setlocal002/TestDescription.java   8300708 generic-all
vmTestbase/nsk/jvmti/SetLocalVariable/setlocal001/TestDescription.java   8300708 generic-all
vmTestbase/nsk/jvmti/unit/GetLocalVariable/getlocal003/TestDescription.java 8300708 generic-all

####
## Test fails because it expects to find vthreads in GetAllThreads
vmTestbase/nsk/jvmti/scenarios/allocation/AP11/ap11t001/TestDescription.java 8300712 generic-all
serviceability/jvmti/GetThreadListStackTraces/OneGetThreadListStackTraces.java 8300712 generic-all

####
## assert in src/hotspot/share/oops/instanceStackChunkKlass.cpp:1042
vmTestbase/nsk/jvmti/GetObjectMonitorUsage/objmonusage006/TestDescription.java 8300709 generic-all

####
## NSK JDWP Tests failing with wrapper

vmTestbase/nsk/jdwp/ThreadReference/ForceEarlyReturn/forceEarlyReturn002/forceEarlyReturn002.java 8286789 generic-all


##########
## NSK JDB Tests failing with wrapper

####
## The tests expect an NPE to be uncaught, but nsk.share.MainWrapper
## introduces exception handlers.

vmTestbase/nsk/jdb/uncaught_exception/uncaught_exception002/uncaught_exception002.java 8278470 generic-all
vmTestbase/nsk/jdb/where/where005/where005.java 8278470 generic-all

###
# Test expects that the "up" command should print "End of stack" because there are
# normally no frames above the test's main method. However, nsk.share.MainWrapper
# introduces more frames above the test's main method, so the test fails.

vmTestbase/nsk/jdb/list/list003/list003.java        8300707 generic-all
vmTestbase/nsk/jdb/repeat/repeat001/repeat001.java  8300707 generic-all

####
## NSK JDI tests failing with wrapper

####
## The test expects an NPE to be uncaught, but nsk.share.MainWrapper
## introduces exception handlers.

vmTestbase/nsk/jdi/ExceptionEvent/catchLocation/location002/TestDescription.java 8278470 generic-all

####
## JVMTI PopFrame() is returning OPAQUE_FRAME because vthreads are not supported.
## Note: vmTestbase/nsk/jdi/ThreadReference/popFrames/popframes001 was converted
## to support vthreads and expect the OPAQUE_FRAME error. The others were
## not because they don't add any additional value.

vmTestbase/nsk/jdb/pop_exception/pop_exception001/pop_exception001.java 8285414 generic-all

vmTestbase/nsk/jdi/VirtualMachine/redefineClasses/redefineclasses002/TestDescription.java 8285414 generic-all

vmTestbase/nsk/jdi/Scenarios/invokeMethod/popframes001/TestDescription.java 8285414 generic-all
vmTestbase/nsk/jdi/BScenarios/hotswap/tc01x002/TestDescription.java 8285414 generic-all
vmTestbase/nsk/jdi/BScenarios/hotswap/tc02x001/TestDescription.java 8285414 generic-all
vmTestbase/nsk/jdi/BScenarios/hotswap/tc02x002/TestDescription.java 8285414 generic-all
vmTestbase/nsk/jdi/BScenarios/hotswap/tc04x001/TestDescription.java 8285414 generic-all
vmTestbase/nsk/jdi/BScenarios/hotswap/tc04x002/TestDescription.java 8285414 generic-all
vmTestbase/nsk/jdi/BScenarios/hotswap/tc06x001/TestDescription.java 8285414 generic-all
vmTestbase/nsk/jdi/BScenarios/hotswap/tc08x001/TestDescription.java 8285414 generic-all
vmTestbase/nsk/jdi/BScenarios/hotswap/tc10x002/TestDescription.java 8285414 generic-all

vmTestbase/nsk/jdi/ThreadReference/popFrames/popframes002/TestDescription.java 8285414 generic-all
vmTestbase/nsk/jdi/ThreadReference/popFrames/popframes003/TestDescription.java 8285414 generic-all
vmTestbase/nsk/jdi/ThreadReference/popFrames/popframes004/TestDescription.java 8285414 generic-all

####
## JVMTI ForceEarlyReturn not supported for vthreads (JVMTI_ERROR_OPAQUE_FRAME)
## Note forceEarlyReturn002 was converted to support vthreads. The rest were not
## since there is no added value (JVMTI_ERROR_OPAQUE_FRAME is expected).

vmTestbase/nsk/jdi/ThreadReference/forceEarlyReturn/forceEarlyReturn014/forceEarlyReturn014.java 8285415 generic-all
vmTestbase/nsk/jdi/stress/serial/forceEarlyReturn001/TestDescription.java 8285415 generic-all
vmTestbase/nsk/jdi/stress/serial/forceEarlyReturn002/TestDescription.java 8285415 generic-all

###
# This test always times out on windows. This is due to the test forcing OOME in the
# debuggee, which has the side affect of making the Read-Poller thread exit. Because
# of this no vthreads can complete their reads, and the test times out as a result.

vmTestbase/nsk/jdi/VMOutOfMemoryException/VMOutOfMemoryException001/VMOutOfMemoryException001.java 8285417 windows-all



##########
## Tests failing when virtual thread factory is enabled
## They are not compatible with virtual thread factory mode and not going to be fixed

####
# OOME in unexpected thread
gc/g1/ihop/TestIHOPStatic.java 0000000 generic-all

####
# Test failing because of incorrect stacktrace or thread properties for main thread

runtime/condy/staticInit/TestInitException.java 0000000 generic-all
runtime/handshake/HandshakeWalkStackTest.java 0000000 generic-all
runtime/handshake/HandshakeWalkStackFallbackTest.java 0000000 generic-all
runtime/ErrorHandling/TestCrashOnOutOfMemoryError.java 0000000 generic-all
runtime/ErrorHandling/TestExitOnOutOfMemoryError.java 0000000 generic-all
runtime/ErrorHandling/TestHeapDumpPath.java 0000000 generic-all
runtime/ErrorHandling/TestOnOutOfMemoryError.java 0000000 generic-all
runtime/ErrorHandling/MachCodeFramesInErrorFile.java 0000000 generic-all
runtime/Thread/ThreadPriorities.java 0000000 generic-all
runtime/Throwable/StackTraceLogging.java 0000000 generic-all
runtime/Throwable/TestMaxJavaStackTraceDepth.java 0000000 generic-all
runtime/Throwable/TestThrowable.java 0000000 generic-all
serviceability/tmtools/jstack/DaemonThreadTest.java 0000000 generic-all
serviceability/dcmd/thread/ThreadDumpToFileTest.java 0000000 generic-all
serviceability/dcmd/thread/PrintTest.java 0000000 generic-all
serviceability/dcmd/thread/PrintConcurrentLocksTest.java 0000000 generic-all

####
# Does not support JVMTI StopThread
runtime/Thread/StopAtExit.java 0000000 generic-all
runtime/Thread/AsyncExceptionOnMonitorEnter.java 0000000 generic-all

####
# Something wrong with test.jdk/test.src properties



####
# Don't work with ProcessTools wrapper because of permissions or classpath
runtime/cds/appcds/jigsaw/classpathtests/EmptyClassInBootClassPath.java 0000000 generic-all
runtime/cds/appcds/jigsaw/modulepath/OptimizeModuleHandlingTest.java 0000000 generic-all
runtime/classFileParserBug/TestEmptyBootstrapMethodsAttr.java 0000000 generic-all

runtime/BootstrapMethod/TestLambdaExceptionInInitializer.java 0000000 generic-all
runtime/logging/VtablesTest.java 0000000 generic-all
serviceability/sa/TestCpoolForInvokeDynamic.java 0000000 generic-all
compiler/ciReplay/TestVMNoCompLevel.java 0000000 generic-all
runtime/logging/LoaderConstraintsTest.javaruntime/logging/LoaderConstraintsTest.java 0000000 generic-all
runtime/jni/checked/TestCheckedEnsureLocalCapacity.java 0000000 generic-all


####
# GC tests failing because test expected results differ with vthread

gc/TestAgeOutput.java#id1 0000000 generic-all
gc/TestAgeOutput.java#id0 0000000 generic-all
gc/arguments/TestNewSizeThreadIncrease.java 0000000 generic-all
gc/g1/TestSkipRebuildRemsetPhase.java 0000000 generic-all
gc/g1/TestStringDeduplicationYoungGC.java 0000000 generic-all
gc/g1/TestStringDeduplicationTableRehash.java 0000000 generic-all
gc/g1/TestStringDeduplicationTableResize.java 0000000 generic-all
gc/g1/TestStringDeduplicationPrintOptions.java 0000000 generic-all
gc/g1/TestStringDeduplicationFullGC.java 0000000 generic-all
gc/g1/TestStringDeduplicationAgeThreshold.java 0000000 generic-all
gc/g1/TestRemsetLoggingPerRegion.java 0000000 generic-all
gc/g1/TestRemsetLogging.java 0000000 generic-all
gc/g1/TestMixedGCLiveThreshold.java#25percent 0000000 generic-all
gc/g1/plab/TestPLABResize.java 0000000 generic-all

####
## Expected exception is ignored

runtime/condy/BadBSMUseTest.java 0000000 generic-all

####
## NSK JMX Tests

####
## Unsupported functionality

vmTestbase/nsk/monitoring/ThreadMXBean/GetThreadAllocatedBytes/baseBehaviorTest_server_default/TestDescription.java 8285419 generic-all
vmTestbase/nsk/monitoring/ThreadMXBean/GetThreadAllocatedBytes/baseBehaviorTest_server_custom/TestDescription.java 8285419 generic-all
vmTestbase/nsk/monitoring/ThreadMXBean/GetThreadAllocatedBytes/baseBehaviorTest_directly/TestDescription.java 8285419 generic-all
vmTestbase/nsk/monitoring/ThreadMXBean/GetThreadAllocatedBytes/baseBehaviorTest_proxy_custom/TestDescription.java 8285419 generic-all
vmTestbase/nsk/monitoring/ThreadMXBean/GetThreadAllocatedBytes/baseBehaviorTest_proxy_default/TestDescription.java 8285419 generic-all


####
## No ThreadInfo for vthreads

vmTestbase/nsk/monitoring/ThreadInfo/isInNative/isinnative001/TestDescription.java 8285420 generic-all
vmTestbase/nsk/monitoring/ThreadInfo/getLockOwnerName/getlockownername001/TestDescription.java 8285420 generic-all
vmTestbase/nsk/monitoring/ThreadInfo/getLockName/getlockname001/TestDescription.java 8285420 generic-all
vmTestbase/nsk/monitoring/ThreadInfo/from_c/from_c001/TestDescription.java 8285420 generic-all
vmTestbase/nsk/monitoring/MemoryUsage/from/from001/TestDescription.java 8285420 generic-all

####
## different number of frames
serviceability/AsyncGetCallTrace/MyPackage/ASGCTBaseTest.java 0000000 generic-all
